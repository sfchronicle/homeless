{% extends 'base.html' %}

{% block title %}{{title}}{% endblock %}

{% block head %}
{% include '_components/_social.html' %}
{% endblock %}

{% block content %}
<main class="container">

	{% include '_components/_header.html' %}

<div id="homelesscontainer">

	<div class="header-opinion" style="z-index: 2;">
		<h1 class="headline-opinion">6,686</h1>
		<h2 class="title h2-opinion">A civic disgrace</h2>

		<div style="padding-top: 15px;">
			
			<p class="author">San Francisco Chronicle</p>
			<p class="date">July 3, 2016</p>

		</div>


	</div>	

	<div class="disappear" id="homelessviz">
		<span class="homeless"></span>
	</div>
</div>

	{% include '_text/opinion.html' %}

	<div class="max">
		<hr>
		<div class="credits">
			{% import '_components/_credits.html' as credit %}
			<!-- Variables are name, email slug and twitter handle -->
			{{ credit.info('San Francisco Chronicle', 'letters', 'sfchronicle' ) }}
			<br>
			Interactive producers
			{{ credit.info('Lucio Villa', 'lvilla', 'luciovilla' ) }}
			{{ credit.info('Benjamin Din', 'bdin', 'benjamindin' ) }}
			{{ credit.info("Emma O'Neill", "eoneill", "emmaruthoneill" ) }}
		</div>
	</div>

	{% import '_components/_related_stories.html' as related %}
	<div class="max">
		<hr>
		<div class="dont-miss">
		<!-- Variables are title, url and image url -->
			<!-- {{ related.story('TITLE', 'URL', '../static/images/test/01.jpg' ) }}
			{{ related.story('TITLE', 'URL', '../static/images/test/01.jpg' ) }}
			{{ related.story('TITLE', 'URL', '../static/images/test/01.jpg' ) }}
			{{ related.story('TITLE', 'URL', '../static/images/test/01.jpg' ) }} -->
		</div>
	</div>

	{% include '_components/_footer.html' %}
</main>
{% endblock %}

{% block javascript %}
<script src="//cdn.jsdelivr.net/velocity/1.2.3/velocity.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.5/ScrollMagic.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.5/plugins/debug.addIndicators.min.js"></script>
<script src="http://scrollmagic.io/scrollmagic/uncompressed/plugins/animation.velocity.js"></script>

<script>
	$(document).ready(function() {
		App.init();
	});
	
	var controller = new ScrollMagic.Controller();

	function populate_humans() {
		for (var i = 0; i < 6686; i ++) {
			if (Math.random() <= 0.66) {
				$('<i class="fa fa-male" aria-hidden="true"></i>').appendTo(".homeless");
			}
			else {
				$('<i class="fa fa-female" aria-hidden="true"></i>').appendTo(".homeless");
			}
		}
	}

	$(document).ready(function() {
		populate_humans();
	});

	$(window).load(function() {

		var animationHeight = $('#homelessviz').height() - 60;

		var newSpeed = 80000;

		var Easing = [ 0.37, 0.67, 0.83, 0.67 ];

		if (screen.width < 480) {
			newSpeed = 60000;
			Easing = "linear"

		}
		else {

			newSpeed = 80000;
			Easing = [ 0.37, 0.67, 0.83, 0.67 ]
			
		}

		$("#homelessviz").offset({top: 0 - animationHeight, left: 0});
		$("#homelessviz").removeClass("disappear");
		$("#homelessviz").velocity({
			top: '0px',
		}, {
			duration: newSpeed,
			easing: Easing
		})


	});

	$("#homelessviz").velocity("stop");

	function sticky_relocate() {
		var window_top = $(window).scrollTop();
		var div_top = $('#sticky-anchor').offset().top - 40;
		if (window_top > div_top) {
				$('#sticky-element').addClass('sticky');
				$('.menu-navigation').addClass('sticky');
		} else {
				$('#sticky-element').removeClass('sticky');
				$('.menu-navigation').removeClass('sticky');
		}
	}

	$(function() {
		$(window).scroll(sticky_relocate);
		sticky_relocate();
	});

	var scene = new ScrollMagic.Scene({triggerElement: "#trigger0"})
	// trigger a velocity opaticy animation
	.setVelocity("#animate0", {
		"font-size": "1.7em", 
		"line-height":"43",
		"color":"#ec1c24"
		}, {duration: 400})
	.addIndicators() // add indicators (requires plugin)
	.addTo(controller);

	var scene = new ScrollMagic.Scene({triggerElement: "#trigger1"})
	// trigger a velocity opaticy animation
	.setVelocity("#animate1", {
		"font-size": "1.7em", 
		"line-height":"40",
		"margin":"4",
		"display":"inline-block",
		"color":"#ec1c24"}, {duration: 400})
	.addIndicators() // add indicators (requires plugin)
	.addTo(controller);

	var scene = new ScrollMagic.Scene({triggerElement: "#trigger2"})
	// trigger a velocity opaticy animation
	.setVelocity("#animate2", {
		"font-size": "1.7em", 
		"line-height":"28",
		"margin":"4",
		"display":"inline-block",
		"color":"#ec1c24"}, {duration: 400})
	.addIndicators() // add indicators (requires plugin)
	.addTo(controller);

	var scene = new ScrollMagic.Scene({triggerElement: "#trigger3"})
	// trigger a velocity opaticy animation
	.setVelocity("#animate3", {
		"font-size": "1.7em", 
		"line-height":"45",
		"margin":"4",
		"display":"inline-block",
		"color":"#ec1c24"}, {duration: 400})
	.addIndicators() // add indicators (requires plugin)
	.addTo(controller);

	var scene = new ScrollMagic.Scene({triggerElement: "#trigger4"})
	// trigger a velocity opaticy animation
	.setVelocity("#animate4", {
		"font-size": "1.6em", 
		"line-height":"35",
		"display":"inline-block",
		"color":"#ec1c24"}, {duration: 400})
	.addIndicators() // add indicators (requires plugin)
	.addTo(controller);

</script>
{% endblock %}